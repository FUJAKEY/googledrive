<%- include('../partials/layout-head'); %>
<section class="admin">
  <h1>Пользователи</h1>
  <p class="text-muted">Управляйте ролями и контролируйте доступ сотрудников.</p>
  <div class="admin-table">
    <div class="table-header">
      <span>Имя</span>
      <span>Email</span>
      <span>Роль</span>
      <span>2FA</span>
      <span>Создан</span>
      <span></span>
    </div>
    <% users.forEach((user) => { %>
      <div class="table-row">
        <div><%= user.name %></div>
        <div><%= user.email %></div>
        <div><span class="tag"><%= user.role %></span></div>
        <div><%= user.two_factor_enabled ? 'Да' : 'Нет' %></div>
        <div><%= user.created_at_formatted %></div>
        <div>
          <form method="post" action="/admin/users/<%= user.id %>/role" class="form-inline">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <select name="role">
              <option value="member" <%= user.role === 'member' ? 'selected' : '' %>>member</option>
              <option value="manager" <%= user.role === 'manager' ? 'selected' : '' %>>manager</option>
              <option value="security" <%= user.role === 'security' ? 'selected' : '' %>>security</option>
              <option value="admin" <%= user.role === 'admin' ? 'selected' : '' %>>admin</option>
            </select>
            <button type="submit" class="btn btn-text">Сохранить</button>
          </form>
        </div>
      </div>
    <% }); %>
  </div>
</section>
<%- include('../partials/layout-foot'); %>
